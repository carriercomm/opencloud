{% extends "base.html" %}
{% block page_header_toolbar %}
<a href="#modal-launch-server" class="btn btn-small btn-primary" data-toggle="modal">{{_('Launch Server')}}</a>
{% endblock %}
{% block main_content %}
<div>
  <ul class="nav nav-tabs">
    {% for region in regions %}
    <li {% if loop.first %}class="active"{% endif %}>
      <a href="#tab-content-servers" class="tab" data-toggle="tab" data-region='{{region.name}}'>{{region.name}}</a>
    </li>
    {% endfor %}
  </ul>

  <div class="tab-content">
    <div class="tab-pane active" id="tab-content-servers">
    </div>
  </div>
</div>
<script type="text/javascript">
$(function(){
    $(".tab").click(function(){
        var provider = $(this).attr('data-region');
        loadNodes(provider);
    });
    $("select#current-organization").on('orgChange', function() {
        loadNodes(null); 
    });
    function loadNodes(provider) {
        var org = $("#current-organization").val();
        var query = provider ? '?provider=' + provider : '';
        $("#tab-content-servers").load("{{url_for('dashboard.nodes')}}" + query);  
    };

    loadNodes();
});
</script>
{% endblock %}
